

<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
    <link href="https://mbinary0.github.io/resource/github.markdown.css" rel="stylesheet">
  </head>
  <body>
     	<div><h2>
                <a href="../index.html">&nbsp;&nbsp;<i class="fa fa-level-up"></i>&nbsp;&nbsp;</a>:
                /<a href="../../../../index.html"><i class="fa fa-home"></i></a>/<a href="../../../index.html">数学类</a>/<a href="../../index.html">计算方法</a>/<a href="../index.html">code</a>/<a href="index.html">solve_nonLinear_equation</a>
            </h2>
        </div>
        
        
        <h2>Directories</h2>
        <ul>
        <li><i class="fa fa-meh-o"></i>&nbsp;None</li>
        </ul>

        <h2>Files</h2>
        <ul>
        <li><a href="https://raw.githubusercontent.com/mbinary/USTC-CS-Courses-Resource/master/数学类/计算方法/code/solve_nonLinear_equation/-数学类-计算方法-code-solve_nonLinear_equation目录下的5个文件.zip" ><i class="fa fa-file-zip-o"></i>&nbsp;-数学类-计算方法-code-solve_nonLinear_equation目录下的5个文件.zip---(410.87K)</a></li>
<li><a href="https://raw.githubusercontent.com/mbinary/USTC-CS-Courses-Resource/master/数学类/计算方法/code/solve_nonLinear_equation/1.jpg" ><i class="fa fa-file-picture-o"></i>&nbsp;1.jpg---(57.02K)</a></li>
<li><a href="https://raw.githubusercontent.com/mbinary/USTC-CS-Courses-Resource/master/数学类/计算方法/code/solve_nonLinear_equation/2.jpg" ><i class="fa fa-file-picture-o"></i>&nbsp;2.jpg---(46.27K)</a></li>
<li><a href="https://raw.githubusercontent.com/mbinary/USTC-CS-Courses-Resource/master/数学类/计算方法/code/solve_nonLinear_equation/第2组-朱河勤-PB16030899-zipsolve_nonLinear_equation.zip" ><i class="fa fa-file-zip-o"></i>&nbsp;第2组-朱河勤-PB16030899-zipsolve_nonLinear_equation.zip---(288.95K)</a></li>
<li><a href="https://raw.githubusercontent.com/mbinary/USTC-CS-Courses-Resource/master/数学类/计算方法/code/solve_nonLinear_equation/README.md" ><i class="fa fa-pencil-square-o"></i>&nbsp;README.md---(1.59K)</a></li>
<li><a href="https://raw.githubusercontent.com/mbinary/USTC-CS-Courses-Resource/master/数学类/计算方法/code/solve_nonLinear_equation/README.pdf" ><i class="fa fa-file-pdf-o"></i>&nbsp;README.pdf---(297.38K)</a></li>
<li><a href="https://raw.githubusercontent.com/mbinary/USTC-CS-Courses-Resource/master/数学类/计算方法/code/solve_nonLinear_equation/solve_nonLinear.py" ><i class="fa fa-file-code-o"></i>&nbsp;solve_nonLinear.py---(1.65K)</a></li>
<li><a href="https://raw.githubusercontent.com/mbinary/USTC-CS-Courses-Resource/master/数学类/计算方法/code/solve_nonLinear_equation/test.png" ><i class="fa fa-file-picture-o"></i>&nbsp;test.png---(8.08K)</a></li>
        </ul>

        <div style="text-decration:underline;display:inline">
        <a href="https://github.com/mbinary/USTC-CS-Courses-Resource.git" target="_blank" rel="external"><i class="fa fa-github"></i>&nbsp; Github</a>
        <a href="mailto:&#122;huheqin1@gmail?subject=反馈与建议" style="float:right" target="_blank" rel="external"><i class="fa fa-envelope"></i>&nbsp; Feedback</a>
        </div>

        <h1 style="color:red;text-align:center;" >Read Me</h1>

<p><strong><span style="float:right">PB16030899-朱河勤 <br>2018-5-20<span></strong></p>
<h1 id="_1"><center> 牛顿迭代解非线性方程组</h1>
<blockquote>
<p>书上p186, 附录1程序10</p>
</blockquote>
<h1 id="_2">程序源码</h1>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>

<span class="k">def</span> <span class="nf">solveNonlinearEquations</span><span class="p">(</span><span class="n">funcs</span><span class="p">:[</span><span class="n">sympy</span><span class="o">.</span><span class="n">core</span><span class="p">],</span><span class="n">init_dic</span><span class="p">:</span><span class="nb">dict</span><span class="p">,</span><span class="n">epsilon</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span><span class="n">maxtime</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;solve  nonlinear equations:&#39;&#39;&#39;</span>
    <span class="n">li</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">init_dic</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">li</span><span class="p">}</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ct</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">init_dic</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">],</span><span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;float&#39;</span><span class="p">)</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="n">i</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">init_dic</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">li</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">funcs</span> <span class="p">],</span><span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;float&#39;</span><span class="p">)</span>
        <span class="n">delt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span><span class="o">-</span><span class="n">ys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">delt</span><span class="p">):</span>
            <span class="n">init_dic</span><span class="p">[</span><span class="n">li</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+=</span><span class="n">j</span>
            <span class="n">delta</span><span class="p">[</span><span class="n">li</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">j</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;第{}次迭代: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span><span class="n">init_dic</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ct</span><span class="o">&gt;</span><span class="n">maxtime</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;after iteration for {} times, I still havn&#39;t reach the accurrency.</span><span class="se">\</span>
<span class="s2">                    Maybe this function havsn&#39;t zeropoint</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ct</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">init_dic</span>
        <span class="k">if</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">delta</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">&lt;</span><span class="n">epsilon</span><span class="p">:</span><span class="k">return</span> <span class="n">init_dic</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
    <span class="n">funcs</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="n">y</span><span class="p">]</span>
    <span class="n">init</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span><span class="mf">0.8</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="mf">0.6</span><span class="p">}</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-5</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;迭代法求解非线性方程组&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;| &#39;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;= 0&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;初值: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">init</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;精度: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epsilon</span><span class="p">))</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">solveNonlinearEquations</span><span class="p">(</span><span class="n">funcs</span><span class="p">,</span><span class="n">init</span><span class="p">,</span><span class="n">epsilon</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;结果: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
</pre></div>


<h1 id="_3">算法描述</h1>
<p><img alt="" src="1.jpg" /></p>
<p>直到 delta x, delta y 的绝对值小于epsilon</p>
<h1 id="_4">测试结果</h1>
<p><img alt="" src="test.png" /></p>
    </body>  
</html>
