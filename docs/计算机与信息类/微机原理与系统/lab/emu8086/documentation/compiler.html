<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">









  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.4.2" rel="stylesheet" type="text/css">



  <link rel="icon" type="image/png" sizes="32x32" href="/yinyang.png?v=6.4.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/yinyang.png?v=6.4.2">










<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.4.2',
    sidebar: {"position":"left","width":350,"display":"always","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="compiling the  assembly code            compiling the assembly code           type your code inside the text area, and click compile button. you will be asked for a place where to save the compi">
<meta property="og:type" content="website">
<meta property="og:title" content="mbinary&#39;s blog">
<meta property="og:url" content="https://mbinary.coding.me/ustc-cs/计算机与信息类/微机原理与系统/lab/emu8086/documentation/compiler.html">
<meta property="og:site_name" content="mbinary&#39;s blog">
<meta property="og:description" content="compiling the  assembly code            compiling the assembly code           type your code inside the text area, and click compile button. you will be asked for a place where to save the compi">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://mbinary.coding.me/ustc-cs/计算机与信息类/微机原理与系统/lab/emu8086/documentation/img/compile01.gif">
<meta property="og:image" content="https://mbinary.coding.me/ustc-cs/计算机与信息类/微机原理与系统/lab/emu8086/documentation/img/compile03.gif">
<meta property="og:updated_time" content="2008-09-14T02:00:00.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mbinary&#39;s blog">
<meta name="twitter:description" content="compiling the  assembly code            compiling the assembly code           type your code inside the text area, and click compile button. you will be asked for a place where to save the compi">
<meta name="twitter:image" content="https://mbinary.coding.me/ustc-cs/计算机与信息类/微机原理与系统/lab/emu8086/documentation/img/compile01.gif">



  <link rel="alternate" href="/atom.xml" title="mbinary's blog" type="application/atom+xml" />




  <link rel="canonical" href="https://mbinary.coding.me/ustc-cs/计算机与信息类/微机原理与系统/lab/emu8086/documentation/compiler.html"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title> | mbinary's blog</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">mbinary's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类<span class="badge">15</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签云<span class="badge">47</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />时间轴<span class="badge">39</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-leetcode">
    <a href="/leetcode/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-line-chart"></i> <br />leetcode</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-ustc-cs menu-item-active">
    <a href="/ustc-cs/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />CS课程资源</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="我来帮你找( •̀ ω •́ )✧" spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    

  


          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

<h2 class="post-title" itemprop="name headline"></h2>

<div class="post-meta">
  
  


  
  
  <ul class="breadcrumb">
    
      
      
        
          <li><a href="/ustc-cs/">USTC-CS</a></li>
          
            
          
        
      
    
      
      
        
          <li><a href="/ustc-cs/计算机与信息类/">计算机与信息类</a></li>
          
            
          
        
      
    
      
      
        
          <li><a href="/ustc-cs/计算机与信息类/微机原理与系统/">微机原理与系统</a></li>
          
            
          
        
      
    
      
      
        
          <li><a href="/ustc-cs/计算机与信息类/微机原理与系统/lab/">LAB</a></li>
          
            
          
        
      
    
      
      
        
          <li><a href="/ustc-cs/计算机与信息类/微机原理与系统/lab/emu8086/">EMU8086</a></li>
          
            
          
        
      
    
      
      
        
          <li>DOCUMENTATION</li>
        
      
    
      
      
        
          <li><a href="/ustc-cs/计算机与信息类/微机原理与系统/lab/emu8086/compiler.html/">COMPILER.HTML</a></li>
          
            
          
        
      
    
  </ul>


</div>

</header>

      
      
      
      <div class="post-body han-init-context">
        
        
          <script src="/assets/js/APlayer.min.js"> </script>
<html>

<head><meta name="generator" content="Hexo 3.8.0">

<!-- hexo-inject:begin --><!-- hexo-inject:end --><title>compiling the  assembly code</title>

<meta name="description" content="Compiling Assembly Code"><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#FF0000">


<!-- hexo-inject:begin --><!-- hexo-inject:end --><font face="Verdana" size="3">

<font size="+2">
<b>compiling the assembly code</b>
</font>

<br><br>

<br>

<img src="img/compile01.gif">

<br><br>

type your code inside the text area, and click <b>compile</b>
button. you will be asked for a place where to save the compiled file.<br>
after successful compilation you can click <b>emulate</b> button to
load the compiled file in emulator.

<br><br>

<hr>
 <b>the output file type directives:</b><br><br>
<pre>
<font face="fixedsys">
	     #make_com#
	     #make_bin#
	     #make_boot#
	     #make_exe#</font></pre>
you can insert these directives in the source code to specify the
required output type for the file. only if compiler cannot determine the output type automatically and it when it
cannot find any of these directives it may ask you for <i>output type</i> before creating the file.
<br><br>
there is virtually no difference between how .com and .bin are assembled because these files are raw binary files,
but .exe file has a special header in the beginning of the file that is used by the operating system
to determine some properties of the executable file.
<br><br>


<hr>

<br>
<b>description of output file types:</b>
<br><br>
<ul>
	<li>
	<b>#make_com#</b> - the oldest and the simplest format of an executable file,
	such files are loaded with 100h prefix (256 bytes). Select <b>Clean</b> from
	the <b>New</b> menu if you plan to compile a COM file. Compiler directive
	<b>ORG 100h</b> should be added before the code. Execution always starts
	from the first byte of the file. This file type is selected automatically if <b>org 100h</b> directive is found in the code.<br>
	supported by DOS and Windows Command Prompt.
	<br><br><br><br>
    </li>

	<li>
	<b>#make_exe#</b> - more advanced format of an executable file. not limited
	by size and number of segments. stack segment should be defined in the
	program. you may select <b>exe template</b> from the <b>new</b> menu in
	to create a simple exe program with pre-defined data, stack, and code segments.<br>
	the entry point (where execution starts) is defined by a programmer. this file type is selected automatically if <b>stack</b> segment is found.<br>
	supported by dos and windows command prompt.
	<br><br><br><br>
    </li>

	<li>
	<b>#make_bin#</b> - a simple executable file. You can define the values
	of all registers, segment and offset for memory area where this file will
	be loaded. When loading "<b>MY.BIN</b>" file to emulator
	it will look for a "<b>MY.BINF</b>" file,
	and load "<b>MY.BIN</b>" file to location specified
	in "<b>MY.BINF</b>" file, registers are also set using
	information in that file (open this file in a text editor to edit or investigate).
	<br>
	in case the emulator is not able to find "<b>MY.BINF</b>"
	file, current register values are used
	and "<b>MY.BIN</b>" file is loaded at current <b>CS:IP</b>.
	<br>
	the execution starts from values in <b>CS:IP</b>.<br>
	bin file type is not unique to the emulator, however the directives are unique and will not work if .bin file is executed outside of the emulator because their output is stored in a separate file independently from pure binary code.

	<br><br>

   <!-- 1.25 -->


    <b>.BINF</b> file is created automatically if assembler finds any of the following directives.<br><br>
    these directives can be inserted into any part of the source code to preset registers or memory before starting the program's execution:
    <table border="1" cellpadding="10" width="80%"><tr><td>
    <pre><font face="Fixedsys">
	#make_bin#
	#LOAD_SEGMENT=1234#
	#LOAD_OFFSET=0000#
	#AL=12#
	#AH=34#
	#BH=00#
	#BL=00#
	#CH=00#
	#CL=00#
	#DH=00#
	#DL=00#
	#DS=0000#
	#ES=0000#
	#SI=0000#
	#DI=0000#
	#BP=0000#
	#CS=1234#
	#IP=0000#
	#SS=0000#
	#SP=0000#
	#MEM=0100:FFFE,00FF-0100:FF00,F4#</font></pre>
	</td></tr></table>
   <!-- end -->
<br>
	all values must be in hexadecimal.<br><br>

	when not specified these values are set by default:<br>
	<font color="GREEN">
	<b>LOAD_SEGMENT = 0100</b><br>
	<b>LOAD_OFFSET  = 0000</b><br>
	<b>CS = ES = SS = DS = 0100</b><br>
	<b>IP = 0000</b><br>
	</font>
 <br>

	if <b>LOAD_SEGMENT</b> and <b>LOAD_OFFSET</b> are not defined, then
	<b>CS</b> and <b>IP</b>	values are used and vice-versa.
	<br><br>



"#mem=..." directive can be used to write values to memory before program starts <br>
 <b>#MEM=nnnn,[bytestring]-nnnn:nnnn,[bytestring]# </b><br>
 for example:<br>
 <b>#MEM=1000,01ABCDEF0122-0200,1233#</b><br>
 all values are in hex, nnnn - for physical address, or (nnnn:nnnn) for logical address.<br>
 <font size="+1"><b>-</b></font> separates the entries. spaces are allowed inside.
 <br><br>
 note: all values are in hex. hexadecimal suffix/prefix is not required. for each byte there must be exactly 2 characters, for example: 0A, 12 or 00.
<br><br>






if none of the above directives directives are preset in source code, binf file is not created.<br>
when emulator loads .bin file without .binf file it will use <b>c:\emu8086\default.binf</b> instead.
<br>
this also applies to any other files with extensions that are unfamiliar to the emulator.



<hr>
<br>

	the format of a typical <b>".BINF</b>" file:<br><br>
	<table border="1" cellpadding="10" width="80%"><tr><td>
	<pre>
	<font face="Fixedsys">
	8000         ; load to segment.
	0000         ; load to offset.
	55           ;   AL
	66           ;   AH
	77           ;   BL
	88           ;   BH
	99           ;   CL
	AA           ;   CH
	BB           ;   DL
	CC           ;   DH
	DDEE         ;   DS
	ABCD         ;   ES
	EF12         ;   SI
	3456         ;   DI
	7890         ;   BP
	8000         ;   CS
	0000         ;   IP
	C123         ;   SS
	D123         ;   SP </font>	</pre>
	</td></tr></table>
	<br>
	we can observe that first goes a number in hexadecimal form and then a comment.<br>
	Comments are added just to make some order, when emulator loads a <b>BINF</b>
	file it does not care about comments it just looks for a values on specific
	lines, so line order is very important.
<br>
    <b>NOTE: existing .binf file is automatically overwritten on re-compile.</b>
<hr>


	<br>
	In case <b>load to offset</b> value is not zero (0000), <b>ORG ????h</b> should
	be added to the source of a <b>.BIN</b> file where <b>????h</b> is the <i>loading offset</i>,
	this should be done to allow compiler calculate correct addresses.
	<br><br>

   <br><br>
    </li>

	<li>
	<b>#make_boot#</b> - this type is a copy of the first track
                       of a floppy disk (boot sector). the only difference from #make_bin# is that loading segment is predefined to 0000:7c00h (this value is written to accompanied .binf file). in fact you can use #make_bin# without any lack of performance, however to make correct test in emulator you will need to add these directives: #cs=0#  and #ip=7c00#  - assembler writes these values into .binf file.
	<br>
     You can write a boot sector of
     a virtual floppy (FLOPPY_0) via menu in
     emulator:<br>
     <b>[virtual drive] -> [write 512 bytes at 7c00 to boot sector]</b>
     <br>
     first you should compile a <b>.bin</b> file and
     load it in emulator (see "<b>micro-os_loader.asm</b>" and "<b>micro-os_kernel.asm</b>"
     in c:\emu8086\examples for more information).

     <br><br>
     then select <b>[virtual drive] -> [boot from floppy]</b> menu to boot
     emulator from a virtual floppy.

     <br><br>
     then, if you are curious, you may write
     the same files to real floppy and
     boot your computer from it. you can use
     "writebin.asm" from c:\emu8086\examples\<br>
      micro-operating system does not have ms-dos/windows compatible boot sector, so it's better
      to use an empty floppy disk. refer to <a href="asm_tutorial_11.html">tutorial 11</a> for more information.
	<br>
    compiler directive
	<b>org 7c00h</b> should be added before the code, when computer
	starts it loads first track of a floppy disk at the address 0000:7c00.
	<br>
	the size of a <b>boot record</b> file should be less then 512 bytes
	(limited by the size of a disk sector).
	<br>
	execution always starts	from the first byte of the file.<br>
	this file type is unique to emu8086 emulator.
	<br><br>
    </li>

</ul>

<hr>

<br>
<b>error processing</b>

<br><br>
assembly language compiler (or assembler) reports about errors in a separate information window:
<br><br>

<img src="img/compile03.gif">

<br><br>

<font face="Fixedsys">MOV DS, 100</font> - is illegal instruction because
segment registers cannot
be set directly, general purpose register should be used, for example<br>
<font face="Fixedsys">
MOV AX, 100<br>
MOV DS, AX
</font>

<br><br>

<font face="Fixedsys">MOV AL, 300</font> - is illegal instruction because
<b>AL</b> register has only 8 bits, and thus maximum value for it is 255 (or 11111111b),
and the minimum is -128.<br>

<br><br>

<hr>

<br>


<!-- obsolete -->
<!--
Compiler makes several passes before generating the correct
machine code, if it finds an error and does not complete the required
number of passes it may show incorrect error messages. For example:

<PRE><FONT FACE="Fixedsys">
ORG 100h

MOV AX, 0
MOV CX, 5
m1: INC AX
LOOP m1                ; not a real error!

MOV AL, 0FFFFh         ; error is here.

RET</FONT></PRE>

<FONT FACE="MS Sans Serif" SIZE=2>
List of generated errors:<BR>
(7) Condition Jump out of range!: LOOP m1<BR>
(9) Wrong parameters: MOV  AL, 0FFFFh<BR>
(9) Operands do not match: Second operand is over 8 bits! <BR>
</FONT>

<BR>
First error message (7) is incorrect, compiler did not finish calculating
the offsets for labels, so it presumes that the offset of <B>m1</B> label
is <B>0000</B>, that address is out of the range because we start at offset <B>100h</B>.
(note: wrong error message does not appear in the latest version of emu8086).

<BR><BR>

Make correction to this line: <B>MOV AL, 0FFFFh</B>
(AL cannot hold <B>0FFFFh</B> value). This fixes both errors!
For example:
<BR><BR>
<PRE><FONT FACE="Fixedsys">
ORG 100h

MOV AX, 0
MOV CX, 5
m1: INC AX
LOOP m1                ; same code, but no error!

MOV AL, 0FFh           ; fixed!

RET</FONT></PRE>

<HR>



-->





<br>
When saving an assembled file, compiler also saves 2 other files that are later used
by the emulator to show original source code when you run the binary executable, and select corresponding lines.
Very often the original code differs from the disabled code because there are no comments,
no segment and no variable declarations. Compiler directives produce no binary code,
but everything is converted to pure machine code.
Sometimes a single original instruction is assembled into several machine code instructions, this is done mainly for the compatibility with
original 8086 microprocessor (for example <b>ROL AL, 5</b> is assembled into five sequential <b>ROL AL, 1</b> instructions).

<ul>

<li> <b>*.~asm</b> - this file contains the original source code that was used to
                     make an executable file.<br><br></li>

<li> <b>*.debug</b> - this file has information that enables the
                      emulator select lines of original source code while
                      running the machine code.<br><br></li>

<li> <b>*.symbol</b> - symbol table, it contains information that enables to show
                       the "variables" window. It is a plain text file, so you may
                       view it in any text editor  (including emu8086 source editor).
						<br><br></li>

<li> <b>*.binf</b> - this ASCII file contains information
                      that is used by emulator to load BIN file at specified
                      location, and set register values prior execution;
                      (created only if an executable is a BIN file).
						<br><br></li>


</ul>

<hr>

</font>


<br><!-- hexo-inject:begin --><!-- hexo-inject:end -->



<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300,"vOffset":-30},"mobile":{"show":false,"scale":0.3,"display":{"position":"right","width":20,"height":40,"vOffset":-10}},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>

        
      </div>
      
      
      
    </div>
    


  
  
  <ul class="breadcrumb">
    
      
      
        
          <li><a href="/ustc-cs/">USTC-CS</a></li>
          
            
          
        
      
    
      
      
        
          <li><a href="/ustc-cs/计算机与信息类/">计算机与信息类</a></li>
          
            
          
        
      
    
      
      
        
          <li><a href="/ustc-cs/计算机与信息类/微机原理与系统/">微机原理与系统</a></li>
          
            
          
        
      
    
      
      
        
          <li><a href="/ustc-cs/计算机与信息类/微机原理与系统/lab/">LAB</a></li>
          
            
          
        
      
    
      
      
        
          <li><a href="/ustc-cs/计算机与信息类/微机原理与系统/lab/emu8086/">EMU8086</a></li>
          
            
          
        
      
    
      
      
        
          <li>DOCUMENTATION</li>
        
      
    
      
      
        
          <li><a href="/ustc-cs/计算机与信息类/微机原理与系统/lab/emu8086/compiler.html/">COMPILER.HTML</a></li>
          
            
          
        
      
    
  </ul>


    
    
    
  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMDA5Ni82NjUx"></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/yinyang.png"
                alt="mbinary" />
            
              <p class="site-author-name" itemprop="name">mbinary</p>
              <p class="site-description motion-element" itemprop="description">淡泊明志, 宁静致远</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">39</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">15</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">47</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/mbinary" target="_blank" title="GitHub" rel="external nofollow"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://www.linkedin.com/in/cs-heqin-zhu" target="_blank" title="LinkedIn" rel="external nofollow"><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://leetcode-cn.com/mbinary/" target="_blank" title="Leetcode" rel="external nofollow"><i class="fa fa-fw fa-code"></i>Leetcode</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.jianshu.com/u/a3bef26d9911" target="_blank" title="Jianshu" rel="external nofollow"><i class="fa fa-fw fa-pencil"></i>Jianshu</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://wpa.qq.com/msgrd?v=3&uin=414313516&site=qq&menu=yes" target="_blank" title="QQ" rel="external nofollow"><i class="fa fa-fw fa-qq"></i>QQ</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:zhuheqin1@gmail.com" target="_blank" title="Email" rel="external nofollow"><i class="fa fa-fw fa-envelope"></i>Email</a>
                  
                </span>
              
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://mbinary.coding.me/photo/index.html" title="相册" target="_blank">相册</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://mbinary.coding.me/share-books.html" title="书籍" target="_blank">书籍</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://mbinary.coding.me/video.html" title="影视" target="_blank">影视</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://mbinary.coding.me/share/blogs.html" title="博客" target="_blank">博客</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://mbinary.coding.me/share/tools.html" title="工具" target="_blank">工具</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div>
  <span class="with-love">
    <a href="https://github.com/mbinary"><i class="fa fa-github"></i></a>
    <a href="mailto:zhuheqin1@gmail.com?subject=feedback"><i class="fa fa-envelope"></i></a>
    <a href="http://wpa.qq.com/msgrd?v=3&uin=414313516&site=qq&menu=yes"><i class="fa fa-qq"></i></a>
    <a href="https://mbinary.coding.me/atom.xml"><i class="fa fa-feed"></i>
        <span class="with-love" id="heart">(。・∀・)ノ<i class="fa fa-heart"></i></span></a>
</span></div>
<div> 
  <span>
      Host: 
      <a class="host" href="https://mbinary.github.io"><i class="fa fa-github-alt"></i>Github</a>
      <a class="host" href="https://mbinary.coding.me"><i class="fa fa-code"></i>Coding</a>
  </span>
</div>
<div class="copyright">
  <span>
      <a class="theme-link" rel="external nofolow" href="https://hexo.io/themes/index.html">Hexo </a> 
      Theme:
      <a href="https://github.com/theme-next/hexo-theme-next">Next</a>
  </span>
  &nbsp;
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="https://ajax.cat.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.4.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.4.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.4.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.4.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.2"></script>



  



  
    <script type="text/javascript">
      window.livereOptions = {
        refer: 'ustc-cs/计算机与信息类/微机原理与系统/lab/emu8086/documentation/compiler.html'
      };
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('-1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  

  


  
  

  
  
  
    
  
  <script src="https://cdn.jsdelivr.net/npm/pangu@3.3.0/dist/browser/pangu.min.js"></script>
  <script type="text/javascript">pangu.spacingPage();</script>


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=6.4.2"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=6.4.2"></script>


  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('复制')
        }, 300)
      }).append(e)
    })
  </script>


<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300,"vOffset":-30},"mobile":{"show":false,"scale":0.3,"display":{"position":"right","width":20,"height":40,"vOffset":-10}},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
