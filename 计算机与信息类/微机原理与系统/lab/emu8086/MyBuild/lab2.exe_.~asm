;name:
;author: mbinary
;time: 2018-11
;function:
include 'emu8086.inc'
include mymacro.inc
;  this file should be in .../emu8086/inc/
; and the new line should be dos formatted, namely \n\r

.model small
.stack 100h
.data
;filename db 256 dup(0)
filename  db "test.txt",0   ; test.txt  in Mybuild
sortedfile  db "test_sorted.txt",0
size dw ?
handle dw ?
buffer db 1024 dup(0)

.code
.startup
DEFINE_PRINT_STRING   ; str in  si
DEFINE_PRINT_NUM
DEFINE_PRINT_NUM_UNS

filesize filename
mov size, ax

open filename 'r'  handle
fileio handle 'r' size buffer
close handle

print "before sorting: "
printNum buffer  size

sort buffer, 0    ; 1 for reverse

open sortedfile 'w' handle
fileio handle 'w' size buffer
close handle

printn ''
print "after  sorting: "
printNum buffer  size

printNum macro buffer  size
local  L
push ax
push si
push cx
mov cx,size
lea si,buffer
L:
mov ah,0
mov al,[si]
inc si
call print_num_uns
print " "
loop     L

pop cx
pop si
pop ax
printNum endm

quit:
.exit
end




; [SOURCE]: C:\Users\mbinary\Desktop\Î¢»úÔ­Àí\lab\emu8086\MySource\lab2.asm
